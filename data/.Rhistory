# if that first column  vector is numeric...
if(is.numeric(first_column)) {
# take a rounded average of each row of the two columns and
# add the resulting vector to the alc data frame
alc[column_name] <- round(rowMeans(two_columns))
} else {
# else if it's not numeric...
# add the first column vector to the alc data frame
alc[column_name] <- first_column
}
}
# define a new column alc_use by combining weekday and weekend alcohol use
alc <- mutate(alc, alc_use = (Dalc + Walc) / 2)
# define a new logical column 'high_use'
alc <- mutate(alc, high_use = alc_use > 2)
glimpse(alc)
setwd("C:/Users/Anton/Documents/IODS-project/data/")
getwd()
# Saving the dataset locally
write.csv(alc,file="alc")
#sandbox
# install.packages("ggplot2")
install.packages("tidyr")
# muista ottaa G3 pois join_by
library(ggplot2)
library(tidyr)
alc <- read.table("C:/Users/Anton/Documents/IODS-project/data/alc",sep = ",", header=TRUE)
g1 <- ggplot(alc, aes(x = high_use, y = G3, col = sex))
g1 + geom_boxplot()
g2 <- ggplot(alc, aes(x = high_use, y = absences, col = sex))
g2 + geom_boxplot()
alc %>% group_by(sex, high_use) %>% summarise(count = n(), mean_grade = mean(G3))
alc2 <- select(alc, one_of("sex","absences","studytime","G3"))
gather(alc) %>% ggplot(aes(value)) + facet_wrap("key", scales = "free")
install.packages("tidyr")
# Anton Jyrki채inen, 16.11.2018, week 3 R exercise.
# Data used: https://archive.ics.uci.edu/ml/machine-learning-databases/00320/
# install.packages("dplyr")
library(dplyr)
# Files load to variables.
student_mat <- read.table("C:/Users/Anton/Documents/IODS-project/student-mat.csv", sep = ";", header=TRUE)
student_por <- read.table("C:/Users/Anton/Documents/IODS-project/student-por.csv", sep = ";", header=TRUE)
# Structure
str(student_mat)
str(student_por)
# Dimensions
dim(student_mat)
dim(student_por)
join_by <- c("G3", "school", "sex", "age", "address", "famsize", "Pstatus", "Medu", "Fedu", "Mjob", "Fjob", "reason", "nursery","internet")
math_por <- inner_join(student_mat, student_por, by = join_by, suffix = c(".math",".por"))
str(math_por)
dim(math_por)
# create a new data frame with only the joined columns
alc <- select(math_por, one_of(join_by))
# columns that were not used for joining the data
notjoined_columns <- colnames(student_mat)[!colnames(student_mat) %in% join_by]
# print out the columns not used for joining
notjoined_columns
for(column_name in notjoined_columns) {
# select two columns from 'math_por' with the same original name
two_columns <- select(math_por, starts_with(column_name))
# select the first column vector of those two columns
first_column <- select(two_columns, 1)[[1]]
# if that first column  vector is numeric...
if(is.numeric(first_column)) {
# take a rounded average of each row of the two columns and
# add the resulting vector to the alc data frame
alc[column_name] <- round(rowMeans(two_columns))
} else {
# else if it's not numeric...
# add the first column vector to the alc data frame
alc[column_name] <- first_column
}
}
# define a new column alc_use by combining weekday and weekend alcohol use
alc <- mutate(alc, alc_use = (Dalc + Walc) / 2)
# define a new logical column 'high_use'
alc <- mutate(alc, high_use = alc_use > 2)
glimpse(alc)
setwd("C:/Users/Anton/Documents/IODS-project/data/")
getwd()
# Saving the dataset locally
write.csv(alc,file="alc")
#sandbox
# install.packages("ggplot2")
# install.packages("tidyr")
# muista ottaa G3 pois join_by
library(ggplot2)
library(tidyr)
alc <- read.table("C:/Users/Anton/Documents/IODS-project/data/alc",sep = ",", header=TRUE)
g1 <- ggplot(alc, aes(x = high_use, y = G3, col = sex))
g1 + geom_boxplot()
g2 <- ggplot(alc, aes(x = high_use, y = absences, col = sex))
g2 + geom_boxplot()
alc %>% group_by(sex, high_use) %>% summarise(count = n(), mean_grade = mean(G3))
alc2 <- select(alc, one_of("sex","absences","studytime","G3"))
gather(alc2) %>% ggplot(aes(value)) + facet_wrap("key", scales = "free") + geom_bar()
# Anton Jyrki채inen, 16.11.2018, week 3 R exercise.
# Data used: https://archive.ics.uci.edu/ml/machine-learning-databases/00320/
# install.packages("dplyr")
library(dplyr)
# Files load to variables.
student_mat <- read.table("C:/Users/Anton/Documents/IODS-project/student-mat.csv", sep = ";", header=TRUE)
student_por <- read.table("C:/Users/Anton/Documents/IODS-project/student-por.csv", sep = ";", header=TRUE)
# Structure
str(student_mat)
str(student_por)
# Dimensions
dim(student_mat)
dim(student_por)
join_by <- c("G3", "school", "sex", "age", "address", "famsize", "Pstatus", "Medu", "Fedu", "Mjob", "Fjob", "reason", "nursery","internet")
math_por <- inner_join(student_mat, student_por, by = join_by, suffix = c(".math",".por"))
str(math_por)
dim(math_por)
# create a new data frame with only the joined columns
alc <- select(math_por, one_of(join_by))
# columns that were not used for joining the data
notjoined_columns <- colnames(student_mat)[!colnames(student_mat) %in% join_by]
# print out the columns not used for joining
notjoined_columns
for(column_name in notjoined_columns) {
# select two columns from 'math_por' with the same original name
two_columns <- select(math_por, starts_with(column_name))
# select the first column vector of those two columns
first_column <- select(two_columns, 1)[[1]]
# if that first column  vector is numeric...
if(is.numeric(first_column)) {
# take a rounded average of each row of the two columns and
# add the resulting vector to the alc data frame
alc[column_name] <- round(rowMeans(two_columns))
} else {
# else if it's not numeric...
# add the first column vector to the alc data frame
alc[column_name] <- first_column
}
}
# define a new column alc_use by combining weekday and weekend alcohol use
alc <- mutate(alc, alc_use = (Dalc + Walc) / 2)
# define a new logical column 'high_use'
alc <- mutate(alc, high_use = alc_use > 2)
glimpse(alc)
setwd("C:/Users/Anton/Documents/IODS-project/data/")
getwd()
# Saving the dataset locally
write.csv(alc,file="alc")
#sandbox
# install.packages("ggplot2")
# install.packages("tidyr")
# muista ottaa G3 pois join_by
library(ggplot2)
library(tidyr)
alc <- read.table("C:/Users/Anton/Documents/IODS-project/data/alc",sep = ",", header=TRUE)
g1 <- ggplot(alc, aes(x = high_use, y = G3, col = sex))
g1 + geom_boxplot()
g2 <- ggplot(alc, aes(x = high_use, y = absences, col = sex))
g2 + geom_boxplot()
alc %>% group_by(sex, high_use) %>% summarise(count = n(), mean_grade = mean(G3))
alc2 <- select(alc, one_of("sex","absences","studytime","G3"))
alc3  <- alc2[order(alc2[,1],decreasing=TRUE),]
gather(alc3) %>% ggplot(aes(value)) + facet_wrap("key", scales = "free") + geom_bar()
---
output:
html_document: default
pdf_document: default
---
# Logistic regression
Week 2,
Anton Jyrki채inen
First we import the data which we wrangled and saved locally in the first part of the exercise. The data is set to a variable ```alc``` using read.table.
```{r}
alc <- read.table("C:/Users/Anton/Documents/IODS-project/data/alc", sep = ",", header=TRUE)
```
Variables in the dataset:
```{r}
names(alc)
```
The dataset consists of data collected from school reports and questionnaires from two different Portugese schools regarding the performance in two subjects: mathematics and Portugese.
Link to the data [here](https://archive.ics.uci.edu/ml/machine-learning-databases/00320/) and link to metadata
[here](https://archive.ics.uci.edu/ml/datasets/Student+Performance).
Absences, studytime and grades go together quite well when doing analysis of school performance. I expect that absences are positively correlated and studytime and grades negatively correlated with high alcohol use. It would also be interesting to see if gender makes any difference in this. Therefor the variables to be used are ```absences```, ```studytime```, ```G3``` and ```sex```.
Barplot of each variable we're interested in:
```{r}
library(ggplot2);
library(tidyr);
barplotVariables <- select(alc, one_of("sex","absences","studytime","G3"))
gather(barplotVariables) %>% ggplot(aes(value)) + facet_wrap("key", scales = "free") + geom_bar()
```
```{r}
alc %>% group_by(sex, high_use) %>% summarise(count = n(), mean_grade = mean(G3))
```
g1 <- ggplot(alc, aes(x = high_use, y = G3, col = sex))
g1 + geom_boxplot()
g2 <- ggplot(alc, aes(x = high_use, y = absences, col = sex))
g2 + geom_boxplot()
# Anton Jyrki채inen, 16.11.2018, week 3 R exercise.
# Data used: https://archive.ics.uci.edu/ml/machine-learning-databases/00320/
# install.packages("dplyr")
library(dplyr)
# Files load to variables.
student_mat <- read.table("C:/Users/Anton/Documents/IODS-project/student-mat.csv", sep = ";", header=TRUE)
student_por <- read.table("C:/Users/Anton/Documents/IODS-project/student-por.csv", sep = ";", header=TRUE)
# Structure
str(student_mat)
str(student_por)
# Dimensions
dim(student_mat)
dim(student_por)
join_by <- c("G3", "school", "sex", "age", "address", "famsize", "Pstatus", "Medu", "Fedu", "Mjob", "Fjob", "reason", "nursery","internet")
math_por <- inner_join(student_mat, student_por, by = join_by, suffix = c(".math",".por"))
str(math_por)
dim(math_por)
# create a new data frame with only the joined columns
alc <- select(math_por, one_of(join_by))
# columns that were not used for joining the data
notjoined_columns <- colnames(student_mat)[!colnames(student_mat) %in% join_by]
# print out the columns not used for joining
notjoined_columns
for(column_name in notjoined_columns) {
# select two columns from 'math_por' with the same original name
two_columns <- select(math_por, starts_with(column_name))
# select the first column vector of those two columns
first_column <- select(two_columns, 1)[[1]]
# if that first column  vector is numeric...
if(is.numeric(first_column)) {
# take a rounded average of each row of the two columns and
# add the resulting vector to the alc data frame
alc[column_name] <- round(rowMeans(two_columns))
} else {
# else if it's not numeric...
# add the first column vector to the alc data frame
alc[column_name] <- first_column
}
}
# define a new column alc_use by combining weekday and weekend alcohol use
alc <- mutate(alc, alc_use = (Dalc + Walc) / 2)
# define a new logical column 'high_use'
alc <- mutate(alc, high_use = alc_use > 2)
glimpse(alc)
setwd("C:/Users/Anton/Documents/IODS-project/data/")
getwd()
# Saving the dataset locally
write.csv(alc,file="alc")
#sandbox
# install.packages("ggplot2")
# install.packages("tidyr")
# muista ottaa G3 pois join_by
library(ggplot2)
library(tidyr)
alc <- read.table("C:/Users/Anton/Documents/IODS-project/data/alc",sep = ",", header=TRUE)
# g1 <- ggplot(alc, aes(x = high_use, y = G3, col = sex))
# g1 + geom_boxplot()
#
# g2 <- ggplot(alc, aes(x = high_use, y = absences, col = sex))
# g2 + geom_boxplot()
alc %>% group_by(sex, high_use) %>% summarise(count = n(), mean_grade = mean(G3))
alc2 <- select(alc, one_of("sex","absences","studytime","G3"))
gather(alc2) %>% ggplot(aes(value)) + facet_wrap("key", scales = "free") + geom_bar()
# Anton Jyrki채inen, 16.11.2018, week 3 R exercise.
# Data used: https://archive.ics.uci.edu/ml/machine-learning-databases/00320/
# install.packages("dplyr")
library(dplyr)
# Files load to variables.
student_mat <- read.table("C:/Users/Anton/Documents/IODS-project/student-mat.csv", sep = ";", header=TRUE)
student_por <- read.table("C:/Users/Anton/Documents/IODS-project/student-por.csv", sep = ";", header=TRUE)
# Structure
str(student_mat)
str(student_por)
# Dimensions
dim(student_mat)
dim(student_por)
join_by <- c("G3", "school", "sex", "age", "address", "famsize", "Pstatus", "Medu", "Fedu", "Mjob", "Fjob", "reason", "nursery","internet")
math_por <- inner_join(student_mat, student_por, by = join_by, suffix = c(".math",".por"))
str(math_por)
dim(math_por)
# create a new data frame with only the joined columns
alc <- select(math_por, one_of(join_by))
# columns that were not used for joining the data
notjoined_columns <- colnames(student_mat)[!colnames(student_mat) %in% join_by]
# print out the columns not used for joining
notjoined_columns
for(column_name in notjoined_columns) {
# select two columns from 'math_por' with the same original name
two_columns <- select(math_por, starts_with(column_name))
# select the first column vector of those two columns
first_column <- select(two_columns, 1)[[1]]
# if that first column  vector is numeric...
if(is.numeric(first_column)) {
# take a rounded average of each row of the two columns and
# add the resulting vector to the alc data frame
alc[column_name] <- round(rowMeans(two_columns))
} else {
# else if it's not numeric...
# add the first column vector to the alc data frame
alc[column_name] <- first_column
}
}
# define a new column alc_use by combining weekday and weekend alcohol use
alc <- mutate(alc, alc_use = (Dalc + Walc) / 2)
# define a new logical column 'high_use'
alc <- mutate(alc, high_use = alc_use > 2)
glimpse(alc)
setwd("C:/Users/Anton/Documents/IODS-project/data/")
getwd()
# Saving the dataset locally
write.csv(alc,file="alc")
#sandbox
# install.packages("ggplot2")
# install.packages("tidyr")
# muista ottaa G3 pois join_by
library(ggplot2)
library(tidyr)
alc <- read.table("C:/Users/Anton/Documents/IODS-project/data/alc",sep = ",", header=TRUE)
# g1 <- ggplot(alc, aes(x = high_use, y = G3, col = sex))
# g1 + geom_boxplot()
#
# g2 <- ggplot(alc, aes(x = high_use, y = absences, col = sex))
# g2 + geom_boxplot()
alc %>% group_by(sex, high_use) %>% summarise(count = n(), mean_grade = mean(G3))
alc2 <- select(alc, one_of("sex","absences","studytime","G3"))
gather(alc) %>% ggplot(aes(value)) + facet_wrap("key", scales = "free") + geom_bar()
# Anton Jyrki채inen, 16.11.2018, week 3 R exercise.
# Data used: https://archive.ics.uci.edu/ml/machine-learning-databases/00320/
# install.packages("dplyr")
library(dplyr)
# Files load to variables.
student_mat <- read.table("C:/Users/Anton/Documents/IODS-project/student-mat.csv", sep = ";", header=TRUE)
student_por <- read.table("C:/Users/Anton/Documents/IODS-project/student-por.csv", sep = ";", header=TRUE)
# Structure
str(student_mat)
str(student_por)
# Dimensions
dim(student_mat)
dim(student_por)
join_by <- c("G3", "school", "sex", "age", "address", "famsize", "Pstatus", "Medu", "Fedu", "Mjob", "Fjob", "reason", "nursery","internet")
math_por <- inner_join(student_mat, student_por, by = join_by, suffix = c(".math",".por"))
str(math_por)
dim(math_por)
# create a new data frame with only the joined columns
alc <- select(math_por, one_of(join_by))
# columns that were not used for joining the data
notjoined_columns <- colnames(student_mat)[!colnames(student_mat) %in% join_by]
# print out the columns not used for joining
notjoined_columns
for(column_name in notjoined_columns) {
# select two columns from 'math_por' with the same original name
two_columns <- select(math_por, starts_with(column_name))
# select the first column vector of those two columns
first_column <- select(two_columns, 1)[[1]]
# if that first column  vector is numeric...
if(is.numeric(first_column)) {
# take a rounded average of each row of the two columns and
# add the resulting vector to the alc data frame
alc[column_name] <- round(rowMeans(two_columns))
} else {
# else if it's not numeric...
# add the first column vector to the alc data frame
alc[column_name] <- first_column
}
}
# define a new column alc_use by combining weekday and weekend alcohol use
alc <- mutate(alc, alc_use = (Dalc + Walc) / 2)
# define a new logical column 'high_use'
alc <- mutate(alc, high_use = alc_use > 2)
glimpse(alc)
setwd("C:/Users/Anton/Documents/IODS-project/data/")
getwd()
# Saving the dataset locally
write.csv(alc,file="alc")
#sandbox
# install.packages("ggplot2")
# install.packages("tidyr")
# muista ottaa G3 pois join_by
library(ggplot2)
library(tidyr)
alc <- read.table("C:/Users/Anton/Documents/IODS-project/data/alc",sep = ",", header=TRUE)
# g1 <- ggplot(alc, aes(x = high_use, y = G3, col = sex))
# g1 + geom_boxplot()
#
# g2 <- ggplot(alc, aes(x = high_use, y = absences, col = sex))
# g2 + geom_boxplot()
alc %>% group_by(sex, high_use) %>% summarise(count = n(), mean_grade = mean(G3))
alc2 <- select(alc, one_of("sex","absences","studytime","G3"))
gather(alc2) %>% ggplot(aes(value)) + facet_wrap("key", scales = "free") + geom_bar()
hist(alc$absences)
# Anton Jyrki채inen, 16.11.2018, week 3 R exercise.
# Data used: https://archive.ics.uci.edu/ml/machine-learning-databases/00320/
# install.packages("dplyr")
library(dplyr)
# Files load to variables.
student_mat <- read.table("C:/Users/Anton/Documents/IODS-project/student-mat.csv", sep = ";", header=TRUE)
student_por <- read.table("C:/Users/Anton/Documents/IODS-project/student-por.csv", sep = ";", header=TRUE)
# Structure
str(student_mat)
str(student_por)
# Dimensions
dim(student_mat)
dim(student_por)
join_by <- c("G3", "school", "sex", "age", "address", "famsize", "Pstatus", "Medu", "Fedu", "Mjob", "Fjob", "reason", "nursery","internet")
math_por <- inner_join(student_mat, student_por, by = join_by, suffix = c(".math",".por"))
str(math_por)
dim(math_por)
# create a new data frame with only the joined columns
alc <- select(math_por, one_of(join_by))
# columns that were not used for joining the data
notjoined_columns <- colnames(student_mat)[!colnames(student_mat) %in% join_by]
# print out the columns not used for joining
notjoined_columns
for(column_name in notjoined_columns) {
# select two columns from 'math_por' with the same original name
two_columns <- select(math_por, starts_with(column_name))
# select the first column vector of those two columns
first_column <- select(two_columns, 1)[[1]]
# if that first column  vector is numeric...
if(is.numeric(first_column)) {
# take a rounded average of each row of the two columns and
# add the resulting vector to the alc data frame
alc[column_name] <- round(rowMeans(two_columns))
} else {
# else if it's not numeric...
# add the first column vector to the alc data frame
alc[column_name] <- first_column
}
}
# define a new column alc_use by combining weekday and weekend alcohol use
alc <- mutate(alc, alc_use = (Dalc + Walc) / 2)
# define a new logical column 'high_use'
alc <- mutate(alc, high_use = alc_use > 2)
glimpse(alc)
setwd("C:/Users/Anton/Documents/IODS-project/data/")
getwd()
# Saving the dataset locally
write.csv(alc,file="alc")
#sandbox
# install.packages("ggplot2")
# install.packages("tidyr")
# muista ottaa G3 pois join_by
library(ggplot2)
library(tidyr)
alc <- read.table("C:/Users/Anton/Documents/IODS-project/data/alc",sep = ",", header=TRUE)
# g1 <- ggplot(alc, aes(x = high_use, y = G3, col = sex))
# g1 + geom_boxplot()
#
# g2 <- ggplot(alc, aes(x = high_use, y = absences, col = sex))
# g2 + geom_boxplot()
alc %>% group_by(sex, high_use) %>% summarise(count = n(), mean_grade = mean(G3))
alc2 <- select(alc, one_of("sex","absences","studytime","G3"))
gather(alc2) %>% ggplot(aes(value)) + facet_wrap("key", scales = "free") + geom_bar()
barplot(alc$absences, main="Car Distribution", xlab="Number of Gears")
# Anton Jyrki채inen, 16.11.2018, week 3 R exercise.
# Data used: https://archive.ics.uci.edu/ml/machine-learning-databases/00320/
# install.packages("dplyr")
library(dplyr)
# Files load to variables.
student_mat <- read.table("C:/Users/Anton/Documents/IODS-project/student-mat.csv", sep = ";", header=TRUE)
student_por <- read.table("C:/Users/Anton/Documents/IODS-project/student-por.csv", sep = ";", header=TRUE)
# Structure
str(student_mat)
str(student_por)
# Dimensions
dim(student_mat)
dim(student_por)
join_by <- c("G3", "school", "sex", "age", "address", "famsize", "Pstatus", "Medu", "Fedu", "Mjob", "Fjob", "reason", "nursery","internet")
math_por <- inner_join(student_mat, student_por, by = join_by, suffix = c(".math",".por"))
str(math_por)
dim(math_por)
# create a new data frame with only the joined columns
alc <- select(math_por, one_of(join_by))
# columns that were not used for joining the data
notjoined_columns <- colnames(student_mat)[!colnames(student_mat) %in% join_by]
# print out the columns not used for joining
notjoined_columns
for(column_name in notjoined_columns) {
# select two columns from 'math_por' with the same original name
two_columns <- select(math_por, starts_with(column_name))
# select the first column vector of those two columns
first_column <- select(two_columns, 1)[[1]]
# if that first column  vector is numeric...
if(is.numeric(first_column)) {
# take a rounded average of each row of the two columns and
# add the resulting vector to the alc data frame
alc[column_name] <- round(rowMeans(two_columns))
} else {
# else if it's not numeric...
# add the first column vector to the alc data frame
alc[column_name] <- first_column
}
}
# define a new column alc_use by combining weekday and weekend alcohol use
alc <- mutate(alc, alc_use = (Dalc + Walc) / 2)
# define a new logical column 'high_use'
alc <- mutate(alc, high_use = alc_use > 2)
glimpse(alc)
setwd("C:/Users/Anton/Documents/IODS-project/data/")
getwd()
# Saving the dataset locally
write.csv(alc,file="alc")
#sandbox
# install.packages("ggplot2")
# install.packages("tidyr")
# muista ottaa G3 pois join_by
library(ggplot2)
library(tidyr)
alc <- read.table("C:/Users/Anton/Documents/IODS-project/data/alc",sep = ",", header=TRUE)
# g1 <- ggplot(alc, aes(x = high_use, y = G3, col = sex))
# g1 + geom_boxplot()
#
# g2 <- ggplot(alc, aes(x = high_use, y = absences, col = sex))
# g2 + geom_boxplot()
alc %>% group_by(sex, high_use) %>% summarise(count = n(), mean_grade = mean(G3))
alc2 <- select(alc, one_of("sex","absences","studytime","G3"))
gather(alc2) %>% ggplot(aes(value)) + facet_wrap("key", scales = "free") + geom_bar()
barplot(alc$absences)
